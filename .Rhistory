for (i in 1:6){
#data[data$Display.as==StopWords$StopWord[i],]$Category="Stop"
data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category="Stop"
}
RegX[6]
data[grep(RegX[6],data$Display.as,ignore.case=T,invert=FALSE),]$Category
is.character(data[grep(RegX[6],data$Display.as,ignore.case=T,invert=FALSE),]$Category)
is.character(data[grep(RegX[5],data$Display.as,ignore.case=T,invert=FALSE),]$Category)
class((data[grep(RegX[5],data$Display.as,ignore.case=T,invert=FALSE),]$Category))
class((data[grep(RegX[6],data$Display.as,ignore.case=T,invert=FALSE),]$Category))
length((data[grep(RegX[6],data$Display.as,ignore.case=T,invert=FALSE),]$Category))
length((data[grep(RegX[5],data$Display.as,ignore.case=T,invert=FALSE),]$Category))
?if
?'if
?'if'
for (i in 1:length(RegX)){
if (length(length(data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category!=0)))
{
#data[data$Display.as==StopWords$StopWord[i],]$Category="Stop"
data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category="Stop"}
}
length(length(data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category))
length(length(data[grep(RegX[6],data$Display.as,ignore.case=T,invert=FALSE),]$Category))
length(data[grep(RegX[6],data$Display.as,ignore.case=T,invert=FALSE),]$Category)
for (i in 1:length(RegX)){
if (length(data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category!=0))
{
#data[data$Display.as==StopWords$StopWord[i],]$Category="Stop"
data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category="Stop"}
}
head(data)
head(data,100)
write.xlsx2(data,filename="Test1.xlsx")
write.xlsx2(data,file="Test1.xlsx",sheetindex=1)
data[grep("http://t.co",data$Row.Labels,ignore.case=T,invert=FALSE),]$Category="Stop"
head(data)
head(data,100)
write.xlsx2(data,file="Test2.xlsx",sheetindex=1)
length(data[data$category!="Stop"])
length(data[data$Category!="Stop"])
length(data[data$Category!="Stop",])
length(data[data$Category=="Stop",])
length(data[data$Category!="Stop",1])
length(data[data$Category=="Stop",1])
dataCl<-data[data$Category!="Stop",]
write.xlsx2(datacl,file="TestCl.xlsx",sheetindex=1)
write.xlsx2(dataCl,file="TestCl.xlsx",sheetindex=1)
x<-c(1:100)
StopWords
StopWords<-read.csv("StopWords.csv",header=TRUE,stringsAsFactors=FALSE)
StopWords
No<-c(1:1000)
rbind(StopWords,No)
No
rbind(StopWords,No)
rbind(StopWords,c(1:10))
cbind(StopWords,c(1:10))
StopWords
stopwords[346:1346]<-1:1000
StopWords[346:1346]<-1:1000
StopWords[346:1346]<-1:999
StopWords[346:1346]<-1:1001
StopWords[346:1346,]<-1:1000
tail(StopWords)
StopWords[346,]<-4
tail(StopWords)
StopWords[346:350,]<-1:6
StopWords[346:350,]<-1:5
StopWords[346:1346,]<-1:1001
tail(StopWords)
RegX<-paste("\\b^",StopWords$StopWord,"$\\b",sep="")
for (i in 1:length(RegX)){
if (length(data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category!=0))
{
#data[data$Display.as==StopWords$StopWord[i],]$Category="Stop"
data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category="Stop"}
}
dataCl<-data[data$Category!="Stop",]
write.xlsx2(dataCl,file="TestCl2.xlsx",sheetindex=1)
write.csv(StopWords,file="StopWords2.csv")
data[grep("^[m]arketin[g][./:,]$",data$Row.Labels,ignore.case=T),]
head(StopWords)
head(RegX)
data[grep("\\b^marketing[./:,]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^[./:,]marketing$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^[./:,?]marketing$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?]$\\b",data$Row.Labels,ignore.case=T),]$Display.as="MARKETING"
data[grep("\\b^marketing[./:,?]$\\b",data$Row.Labels,ignore.case=T),]
x<-1:10
x
paste(x,"hello")
x
dim(data)
data[,5]<-paste("\\b^",data$Row.Labels,"[./:,?]$\\b")
head(data)
names(data[,5])<-"Regular.Exp"
head(data)
names(data$v5)<-"Regular.Exp"
names(data[,5])<-"Regular.Exp"
name(data[,5])<-"Regular.Exp"
colnames(data[,5])<-"Regular.Exp"
name(data[,5])
colnames(data[,5])
colnames(data[,4])
head(data$v5)
head(data$V5)
colnames(data$V5)<-Regular.Exp
colnames(data$V5)<-"Regular.Exp"
colname(data$V5)<-"Regular.Exp"
V5<-paste("\\b^",data$Row.Labels,"[./:,?]$\\b")
colnames(V5<-"Regular.Exp")
colnames(V5)
<-"Regular.Exp"
colnames(V5)<-"Regular.Exp"
colnames(data[5])<-"Regular.Exp"
head(data)
head(data[5])
colnames(data[5])<-"Regular.Exp"
colnames(data[5])<-"Regular.Exp"
head(data[5])
colnames(data)<-"Regular.Exp"
head(data[5])
head(data)
colnames(data)<-c("Row.Labels","Count.Of.Tweet.ID
")
colnames(data)<-c("Row.Labels","Count.Of.Tweet.ID","Display.As","Category","Regular.Exp")
head(data)
head(data,100)
head(data,200)
data[,5]<-paste("\\b^",data$Row.Labels,"[./:,?!]$\\b")
head(data)
for (i in 1:200){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T)]$Display.as=
data[i]$Display.as
}
for (i in 1:200){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.as=
data[i]$Display.as
}
for (i in 1:200){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.as=
data$Display.as[i]
}
write.xlsx2(data,file="TestCl3.xlsx",sheetindex=1)
data[grep("\\b^marketing[./:,?]$\\b",data$Row.Labels,ignore.case=T),]$Display.as="MARKETING"
data[grep("\\b^marketing[./:,?]$\\b",data$Row.Labels,ignore.case=T),]$Display.as
data
head(data)
data[grep("\\b^marketing[./:,?]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^agency[./:,?]$\\b",data$Row.Labels,ignore.case=T),]
data$Display.as[2]
data$Display.as[1]
data$Display.As[1]
data$Display.As[2]
for (i in 1:200){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[i]
}
data[grep(data$Regular.Exp[1],data$Row.Labels,ignore.case=T),]$Display.As
data[grep(data$Regular.Exp[2],data$Row.Labels,ignore.case=T),]$Display.As
data[grep(data$Regular.Exp[2],data$Row.Labels,ignore.case=T),]
data[grep(data$Regular.Exp[2],]
data[grep(data$Regular.Exp[2]),]
data[grep(data$Regular.Exp[2],data$Row.Labels,ignore.case=T),]
head(data)
data[grep("\\b^marketing[./:,?]$\\b",data$Row.Labels,ignore.case=T),]
data[grep(data$Regilar.Exp,data$Row.Labels,ignore.case=T),]
data[grep(data$Regular.Exp,data$Row.Labels,ignore.case=T),]
data[grep(data$Regular.Exp[1],data$Row.Labels,ignore.case=T),]
data$Regular.Exp[1]
data[grep("\\b^ MARKETING [./:,?!]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?!]$\\b",data$Row.Labels,ignore.case=T),]
data[,5]<-paste("\\b^",data$Row.Labels,"[./:,?!]$\\b")
colnames(data[5])<-"Regular.Exp"
head(data)
data[,5]<-paste("\\b^",data$Row.Labels,"[./:,?!]$\\b",sep="")
head(data)
data[grep(data$Regular.Exp[1],data$Row.Labels,ignore.case=T),]
for (i in 1:200){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[i]
}
for (i in 1:20){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[i]
}
for (i in 10:20){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[i]
}
for (i in 1:2){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[i]
}
for (i in 16:19){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[i]
}
for (i in 17:18){
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[i]
}
data[grep(data$Regular.Exp[17],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[17]
data[grep(data$Regular.Exp[18],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[18]
data[18,]
data[,5]<-paste("\\b^",data$Row.Labels,"[./:,?! ]$\\b",sep="")
data[grep(data$Regular.Exp[18],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[18]
data[grep("\\b^marketing[./:,? ]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?""]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?" "]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?!]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?!]|[]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?!]|[ ]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^marketing[./:,?!]$\\b",data$Row.Labels,ignore.case=T),]
data[grep("\\b^and[./:,?!]$\\b",data$Row.Labels,ignore.case=T),]
for (i in 1:200){
if (length(data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As!=0))
{
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[i]
}
for (i in 1:200){
if (length(data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As!=0))
{
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.As=
data$Display.As[i]
}
}
write.xlsx2(data,file="TestCl4.xlsx",sheetindex=1)
data<-read.xlsx2("WordR.xlsx",sheetIndex=1)
data[grep("http://t.co",data$Row.Labels,ignore.case=T,invert=FALSE),]$Category="Stop"
StopWords<-read.csv("StopWords.csv",header=TRUE,stringsAsFactors=FALSE)
#Set stop words to upper case
StopWords$StopWord=toupper(StopWords$StopWord)
#add numbers to stopwords thing 1 to 1000 should do it
StopWords[346:1346,]<-1:1001
#Turn stopwords into regular expression thing using paste function.
RegX<-paste("\\b^",StopWords$StopWord,"$\\b",sep="")
#Get Stopwords with additional punctuation.
RegXPunct<-paste("\\b^",StopWords$StopWord,"$\\b",sep="")
#----------------------------------------------------------------------------------
#Need to deal with stop words that don't have a corresponding value in the Excel
#file. Length=0 divides them. Use a for loop to substitute for exact matches
#This now works. Huzaah!
for (i in 1:length(RegX)){
if (length(data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category!=0))
#data[data$Display.as==StopWords$StopWord[i],]$Category="Stop"
{
data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category="Stop"}
}
head(data)
head(data,100)
data[,5]<-paste("\\b^",data$Row.Labels,"[./:,?!]$\\b",sep="")
colnames(data[5])<-"Regular.Exp"
head(data)
data[grep(data$Regular.Exp[1],data$Row.Labels,ignore.case=T),]$Display.As
data[grep(data$V5[1],data$Row.Labels,ignore.case=T),]$Display.As
data[grep("\\b^marketing[./:,?!]$\\b",data$Row.Labels,ignore.case=T),]$Display.as="MARKETING"
data[grep("\\b^marketing[./:,?!]$\\b",data$Row.Labels,ignore.case=T),]
data[grep(data$V5[1],data$Row.Labels,ignore.case=T),]
data[grep(data$V5[1],data$Row.Labels,ignore.case=T),]$Display.as
for (i in 1:200){
if (length(data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.as!=0))
{
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.as=
data$Display.as[i]
}
}
for (i in 1:200){
if (length(data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as!=0))
{
data[grep(data$Regular.Exp[i],data$Row.Labels,ignore.case=T),]$Display.as=
data$Display.as[i]
}
}
for (i in 1:200){
if (length(data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as!=0))
{
data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as=
data$Display.as[i]
}
}
write.xlsx2(data,file="Test1.xlsx")
toupper(data$Display.as[1]
)
rm data
rm(data)
data
data<-read.xlsx2("WordR.xlsx",sheetIndex=1)
#Remove links and http://t.co
#Data1<-data[grep("http://t.co",data$Row.Labels,ignore.case=T,invert=TRUE),]
#Assign "Stop" to category variable for links like http://t.co..
data[grep("http://t.co",data$Row.Labels,ignore.case=T,invert=FALSE),]$Category="Stop"
head(data[grep("http://t.co",data$Row.Labels,ignore.case=T,invert=FALSE),])
#----------------------------------------------------------------------------------
#Assign stop words to all english "Stop" words, prepositions etc
StopWords<-read.csv("StopWords.csv",header=TRUE,stringsAsFactors=FALSE)
#Set stop words to upper case
StopWords$StopWord=toupper(StopWords$StopWord)
StopWords[346:1346,]<-1:1001
#add numbers to stopwords thing 1 to 1000 should do it
#Turn stopwords into regular expression thing using paste function.
RegX<-paste("\\b^",StopWords$StopWord,"$\\b",sep="")
#Get Stopwords with additional punctuation.
RegXPunct<-paste("\\b^",StopWords$StopWord,"$\\b",sep="")
#----------------------------------------------------------------------------------
#Need to deal with stop words that don't have a corresponding value in the Excel
#file. Length=0 divides them. Use a for loop to substitute for exact matches
#This now works. Huzaah!
for (i in 1:length(RegX)){
if (length(data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category!=0))
#data[data$Display.as==StopWords$StopWord[i],]$Category="Stop"
{
data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category="Stop"}
}
data[,5]<-paste("\\b^",data$Row.Labels,"[./:,?!]$\\b",sep="")
colnames(data[5])<-"Regular.Exp"
head(data)
dataBU<-data
head(data,100)
data[grep(data$V5[1],data$Row.Labels,ignore.case=T),]$Display.as
data[grep(data$V5[1],data$Row.Labels,ignore.case=T),]
data$Display.as[1]
for (i in 1:20){
if (length(data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as!=0))
{
data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as=
toupper(data$Display.as[i])
}
}
head(data)
head(data,22)
for (i in 1:200){
if (length(data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as!=0))
{
data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as=
toupper(data$Display.as[i])
}
}
head(data,200)
data<-databackup
dataBackup
data<-dataBU
head(dataa)
head(data)
for (i in 1:38){
if (length(data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as!=0))
{
data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as=
toupper(data$Display.as[i])
}
}
head(data,50)
for (i in 1:40){
if (length(data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as!=0))
{
data[grep(data$V5[i],data$Row.Labels,ignore.case=T),]$Display.as=
toupper(data$Display.as[i])
}
}
head(data,50)
data<-dataBU
dataCL<-data[data$Category!="Stop",]
head(data$CL)
head(data)
dataCL<-data[data$Category!="Stop",]
head(dataCL)
for (i in 1:200){
if (length(dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as!=0))
{
dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as=
toupper(dataCL$Display.as[i])
}
}
write.xlsx2(dataCL,file="Test1.xlsx")
data[,5]<-paste("\\b^",data$Row.Labels,"[./:,?!()]$\\b",sep="")
dataCL<-data[data$Category!="Stop",]
for (i in 1:200){
if (length(dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as!=0))
{
dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as=
toupper(dataCL$Display.as[i])
}
}
write.xlsx2(dataCL,file="Test1.xlsx")
dataCL$Display.as[1]
dataCL<-data[data$Category!="Stop",]
for (i in 1:200){
if (length(dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as!=0))
dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as<-
{
toupper(dataCL$Display.as[i])
}
}
write.xlsx2(dataCL,file="Test1.xlsx")
write.xlsx2(dataCL,file="Test1.xlsx")
for (i in 1:200){
if (length(dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as!=0))
{
dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as<-toupper(dataCL$Display.as[i])
}
}
write.xlsx2(dataCL,file="Test1.xlsx")
data[grep("\\b^marketing[./:,?!]$\\b",data$Row.Labels,ignore.case=T),]$Display.as="MARKETING"
dataCL<-data[data$Category!="Stop",]
write.xlsx2(dataCL,file="Test1.xlsx")
hello<-c(1,2,3,4,5);c(6,7,8,9,10)
goodbye<-c(2,3,4,5,6,)
goodbye<-c(2,3,4,5,6)
Derp<-cbind(hello,goodbye)
derp
Derp
Derp$goodbye
Derp[,2]
Derp[,2]=11
Derp
?gsub
dataCL[grep(dataCL$V5[1],dataCL$Row.Labels,ignore.case=T),]
data[grep("\\b^[()]marketing[./:,?!]$\\b",data$Row.Labels,ignore.case=T),]
gsub("[[:punct:]]", "", dataCL$Row.Labels)
dataCL$Row.Labels<-gsub("[[:punct:]]", "", dataCL$Row.Labels)
write.xlsx2(dataCL,file="Test1.xlsx")
for (i in 1:200){
if (length(dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as!=0))
{
dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as
<-toupper(dataCL$Row.Labels[i])
}
}
for (i in 1:200){
if (length(dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as!=0))
{
dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as
<-toupper(dataCL$Row.Labels[i])
}
}
head(dataCL)
dataCL[grep(dataCL$V5[1],dataCL$Row.Labels,ignore.case=T),]$Display.as
dataCL[grep(dataCL$V5[2],dataCL$Row.Labels,ignore.case=T),]$Display.as
for (i in 1:200)
{
if (length(dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as!=0))
{
dataCL[grep(dataCL$V5[i],dataCL$Row.Labels,ignore.case=T),]$Display.as
<-toupper(dataCL$Row.Labels[i])
}
}
head(dataCL,100)
dataCL<-data[data$Category!="Stop",]
dataCL$Display.as<-gsub("[[:punct:]]", "", dataCL$Display.as)
head(dataCL)
head(dataCL,100)
write.xlsx2(dataCL,file="Test1.xlsx")
dataCl2<-aggregate(dataCL$Count.of.Tweet.ID, by=list(dataCL$Display.as),FUN=sum)
dataCL[dataCL$Display.as=="MARKETING",]
head(dataCL$Count.of.Tweet.ID)
head(dataCL$Count.Of.Tweet.ID)
dataCl2<-aggregate(dataCL$Count.Of.Tweet.ID, by=list(dataCL$Display.as),FUN=sum)
dataCL$Count.Of.Tweet.ID<-as.numeric(as.character(dataCL$Count.Of.Tweet.ID))
dataCl2<-aggregate(dataCL$Count.Of.Tweet.ID, by=list(dataCL$Display.as),FUN=sum)
write.xlsx2(dataCL2,file="Test1.xlsx")
write.xlsx2(dataCl2,file="Test1.xlsx")
require(xlsx)
data<-read.xlsx2("WordR.xlsx",sheetIndex=1)
data[grep("http://t",data$Row.Labels,ignore.case=T,invert=FALSE),]$Category="Stop"
StopWords<-read.csv("StopWords.csv",header=TRUE,stringsAsFactors=FALSE)
StopWords$StopWord=toupper(StopWords$StopWord)
RegX<-paste("\\b^",StopWords$StopWord,"$\\b",sep="")
StopWords$StopWord=toupper(StopWords$StopWord)
RegX<-paste("\\b^",StopWords$StopWord,"$\\b",sep="")
data$Display.as<-gsub("[[:punct:]]", "", data$Display.as)
for (i in 1:length(RegX)){
if (length(data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category!=0))
{
#data[data$Display.as==StopWords$StopWord[i],]$Category="Stop"
data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category="Stop"}
}
dataCL<-data[data$Category!="Stop",]
write.xlsx2(dataCl,file="Test1.xlsx")
data$Display.as<-gsub("[[:punct:]]", "", data$Display.as)
head(data,100)
head(data,200)
write.xlsx2(data,file="Test.xlsx")
data[data$Category!="Stop",]="Regular"
data[data$Category!=Stop,]="Regular"
data[which(data$Category!="Stop"),]
data<-read.xlsx2("WordR.xlsx",sheetIndex=1)
data[grep("http://t",data$Row.Labels,ignore.case=T,invert=FALSE),]$Category="Stop"
StopWords<-read.csv("StopWords.csv",header=TRUE,stringsAsFactors=FALSE)
StopWords$StopWord=toupper(StopWords$StopWord)
RegX<-paste("\\b^",StopWords$StopWord,"$\\b",sep="")
data$Display.as<-gsub("[[:punct:]]", "", data$Display.as)
for (i in 1:length(RegX)){
if (length(data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category!=0))
{
#data[data$Display.as==StopWords$StopWord[i],]$Category="Stop"
data[grep(RegX[i],data$Display.as,ignore.case=T,invert=FALSE),]$Category="Stop"}
}
data[which(data$Category!="Stop"),]
data[which(data$Category!="Stop"),]$Category="Regular"
head(data)
write.xlsx2(data,file="Test.xlsx")
dataCL<-data[data$Category!="Stop",]
write.xlsx2(dataCl,file="TestCL.xlsx")
head(data)
head(data,50)
write.xlsx2(dataCL,file="TestCL.xlsx")
